I wrote this super fast and it's a big pile of messy (as are most of my repos). I will make it nice eventually.
